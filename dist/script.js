(()=>{let e,t,o;try{e=0,t=window.speechSynthesis,t||console.log("speechSynthesis not supported!!"),o=new Audio("./wrong.mp3"),o.playbackRate=10}catch(e){console.error(e)}let n,s=0,c=[],r=0,l="",d=e=>!e||/^\s*$/.test(e);function a(e){try{return document.getElementById(`id_${e.toLowerCase()}`)}catch(e){}return!1}function u(){e=document.getElementById("sound_play").checked,document.getElementById("textbox").focus(),r=0,s=0,c=[];for(var t=0;t<10;t++)c.push(Math.random().toString(36).substr(2,15).toUpperCase());n=c[s],l=n[r].toUpperCase(),document.getElementById("question").textContent=n,m(),document.getElementById("question_content").textContent=c.join("\n"),document.querySelector(".set-button").addEventListener("click",(()=>{document.querySelector(".body").classList.contains("show")?document.querySelector(".body").classList.remove("show"):document.querySelector(".body").classList.add("show")})),document.getElementById("score").textContent=`${s}/${c.length}`}function m(){d(l)&&(l="space"),","==l&&(l="comma");let t=a(l);t&&(document.querySelectorAll(".select").forEach((e=>e.classList.remove("select"))),t.classList.add("select"),e&&i(l))}function i(e){try{var o=new SpeechSynthesisUtterance(e);o.lang="en-US",t.speak(o)}catch(e){console.error(e)}}window.addEventListener("load",(()=>{document.getElementById("sound_play").addEventListener("change",(t=>{e=t.target.checked,e&&i(l)})),function(){const e=document.getElementById("textbox");e.addEventListener("focus",(()=>{document.querySelector(".body").classList.remove("show")})),e.addEventListener("keypress",(e=>{let t=e.key.toUpperCase();if(console.log("inputChar",t,e.keyCode),console.log("selChar",l),32==e.keyCode&&(t="space"),44==e.keyCode&&(t="comma"),d(l)&&(l="space"),t!==l){let n=a(t);return n&&(n.classList.add("select-error"),o.play(),setTimeout((()=>n.classList.remove("select-error")),200)),e.preventDefault(),!1}return document.querySelectorAll("button.select").forEach((e=>e.classList.remove("select"))),r>=n.length-1&&(r=-1,s++,n=c[s],document.getElementById("question").textContent=n,setTimeout((()=>document.getElementById("textbox").value=""),100),document.getElementById("score").textContent=`${s}/${c.length}`,s>=c.length)?(setTimeout((()=>{alert("完成！！"),u()}),500),!0):(r++,l=n[r].toUpperCase(),m(),!0)}))}(),u()}))})();