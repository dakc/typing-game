(()=>{const e="dakc_typing_game_question_v1";let t,n,o;function s(){let e=document.getElementById("question_content").value.split("\n");APP_DATA={questionList:e,questionCompleted:0,selectedQuestion:e[0],charIndex:0,playSound:document.getElementById("sound_play").checked,startTime:new Date,inputData:{keyPressCode:0,isJpMode:0,status:{totalInput:0,correctInput:0,wrongInput:0}}},o.value="",o.focus(),document.getElementById("question").textContent=APP_DATA.selectedQuestion,APP_DATA.selectedQuestion&&a(APP_DATA.selectedQuestion[0]),document.getElementById("score").textContent=`${APP_DATA.questionCompleted}/${APP_DATA.questionList.length}`}function a(e){document.querySelectorAll(".select").forEach((e=>e.classList.remove("select")));let n=document.getElementById(`id_${c(e)}`);n&&n.classList.add("select"),APP_DATA.playSound&&function(e){try{var n=new SpeechSynthesisUtterance(e);n.lang="en-US",t.speak(n)}catch(e){console.error(e)}}(e)}function c(e){let t=e.charCodeAt(0);switch(e){case"-":t=189;break;case"^":t=222;break;case"\\":t=220;break;case"@":t=192;break;case"[":t=219;break;case";":t=187;break;case":":t=186;break;case"]":t=221;break;case",":t=188;break;case".":t=190;break;case"/":t=191;break;case"\\":t=226}return t}function A(e,t){let n="";for(var o=0;o<t;o++)n+=Math.random().toString(36).substr(2,e).toUpperCase()+"\n";return n.trim()}!function(){try{n=new Audio("./wrong.mp3"),n.playbackRate=10}catch(e){}try{t=window.speechSynthesis}catch(e){}}(),window.APP_DATA={},window.STR_LENGTH=10,window.QUESTION_COUNT=5,window.addEventListener("load",(()=>{o=document.getElementById("textbox"),function(){let e=[243,244,229],t=e=>e.keyCode||e.charCode;function A(e){APP_DATA.inputData.isJpMode=229==t(e)}function u(e){APP_DATA.inputData.keyPressCode=t(e)}function i(o){APP_DATA.inputData.keyUpCode=t(o),console.log("APP_DATA.inputData",APP_DATA.inputData),!APP_DATA.inputData.isJpMode||e.includes(APP_DATA.inputData.keyUpCode)?function(){if(APP_DATA.inputData.status.totalInput++,e=APP_DATA.inputData.keyUpCode,t=c(APP_DATA.selectedQuestion[APP_DATA.charIndex]),console.log("input",e,"target",t),e===t)APP_DATA.inputData.status.correctInput++,function(){if(APP_DATA.charIndex>=APP_DATA.selectedQuestion.length-1){if(APP_DATA.charIndex=-1,APP_DATA.questionCompleted++,APP_DATA.questionCompleted>=APP_DATA.questionList.length)return setTimeout((()=>{let e=new Date;APP_DATA.inputData.status.timeTaken=Math.ceil(e.getTime()-APP_DATA.startTime.getTime())/1e3,alert(`完成！！\nTime: ${APP_DATA.inputData.status.timeTaken}秒`),s()}),500),!0;APP_DATA.selectedQuestion=APP_DATA.questionList[APP_DATA.questionCompleted],document.getElementById("question").textContent=APP_DATA.selectedQuestion,setTimeout((()=>document.getElementById("textbox").value=""),100)}APP_DATA.charIndex++,a(APP_DATA.selectedQuestion[APP_DATA.charIndex])}();else{APP_DATA.inputData.status.wrongInput++,APP_DATA.playSound&&n.play();let e=document.getElementById(`id_${APP_DATA.inputData.keyUpCode}`);e&&(e.classList.add("select-error"),setTimeout((()=>e.classList.remove("select-error")),200))}var e,t;document.getElementById("score").innerHTML=`${APP_DATA.questionCompleted}/${APP_DATA.questionList.length}`,document.getElementById("correctness").innerHTML=`${Math.floor(APP_DATA.inputData.status.correctInput/APP_DATA.inputData.status.totalInput*100)}`,document.getElementById("time").innerHTML=Math.ceil(((new Date).getTime()-APP_DATA.startTime.getTime())/1e3)}():alert("入力を「半角英数字」モードに切り替えてください！！")}o.addEventListener?(o.addEventListener("keydown",A,!1),o.addEventListener("keypress",u,!1),o.addEventListener("keyup",i,!1)):(o.attachEvent("onkeydown",A),o.attachEvent("onkeypress",u),o.attachEvent("onkeyup",i))}(),o.addEventListener("focus",(()=>{document.querySelector(".body").classList.remove("show")})),document.querySelector(".set-button").addEventListener("click",(()=>{document.querySelector(".body").classList.contains("show")?document.querySelector(".body").classList.remove("show"):document.querySelector(".body").classList.add("show")}));let t=localStorage.getItem(e)||A(STR_LENGTH,QUESTION_COUNT);console.log("question",t),document.getElementById("question_content").value=t,s(),document.getElementById("btn_save").addEventListener("click",(()=>{let t=document.getElementById("question_content").value;document.getElementById("question_content").value=t.toUpperCase(),localStorage.setItem(e,t.toUpperCase()),s()})),document.getElementById("btn_save_random").addEventListener("click",(()=>{document.getElementById("question_content").value=A(STR_LENGTH,QUESTION_COUNT),s()}))}))})();